within {{project_name}}.Districts;
model DistrictHeatingSystem
  "Example to test the 4G district heating system."
  extends Modelica.Icons.Example;
  {% raw %}package MediumW=Buildings.Media.Water
    "Medium model for water";
  inner parameter DesignDataParallel4GDC datDes(
    nBui=nBui,
    mDis_flow_nominal=sum(
      {bui_ETS[i].ets.mDis_flow_nominal for i in 1:nBui}),
    mCon_flow_nominal={bui_ETS[i].ets.mDis_flow_nominal for i in 1:nBui},
    lDis=fill(
      5,
      nBui),
    lCon=fill(
      5,
      nBui),
    lEnd=5,
    dhDis={0.05,0.04},
    dhCon=fill(
      0.015,
      nBui),
    dhEnd=0.04)
    "Design data"
    annotation (Placement(transformation(extent={{-80,20},{-60,40}})));
  parameter Integer nBui=2
    "number of coonected buildings";
  parameter Modelica.SIunits.PressureDifference dpDis_nominal[nBui](
    each min=0,
    each displayUnit="Pa")=1/2 .* cat(
    1,
    {dp_nominal*0.05},
    fill(
      dp_nominal*0.95/(nBui-1),
      nBui-1))
    "Pressure drop between each connected building at nominal conditions (supply line)";
  parameter Modelica.SIunits.HeatFlowRate Q_flow_nominal=50000
    "Heating load";
  parameter Modelica.SIunits.PressureDifference dp_nominal=dpSetPoi+nBui*7000;
;
